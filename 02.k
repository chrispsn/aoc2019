f:* ({~99=x@y}/) {i:x@y+!4;n:@[x;i@3;$[1=*i;+;*]/ x@i@1 2];(n;y+4)}//

d1:@[.-1_1:`02.txt;1 2;:;12 2]
*f(d1;0)

d2:@[d1;1 2;:;]'z:+!2#100
100/:*z@&19690720=+*+f'+(d2;0)   / 100/: instead of {y+100*x}/ via Leah Neukirchen

/ answers: 6730673 3749

/ Tests
2 0 0 0 99 ~  f (1 0 0 0 99;0)
2 3 0 6 99 ~  f (2 3 0 3 99;0)
2 4 4 5 99 9801 ~ f (2 4 4 5 99 0;0)
30 1 1 4 2 5 6 0 99 ~ f (1 1 1 4 99 5 6 0 99;0)
\\
